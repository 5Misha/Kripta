# Детекция оборудования

Данный проект я делал для практики в университете. Его основная задача та же, что и в проекте, который находится у меня в папке со стажировки, но там я делал его в команде, а тут он выполнен мною, так как эту задачу мне захотелось сделать одному. Заодно здесь я смогу не только рассказать, но и показать, что сделал. 

Как это было описано в другом репозитории, основная задача данного проекта по предосталвенным размеченным данным в формате XML и фотографиям обучить модель, которая будет находить, классифицировать и выделять различные устройства. Для этой задачи я использовал модель YOLO11m. 

Первой основной задачей, с которой я столкнулся, это формат предоставленных данных. Так как нам предоставили данные не в том формате, в котором мы просили, а используется модель YOLO, то нужно перевести формат XML в YAML. Для этого был написан код ([data_preparation](https://github.com/5Misha/Personal_projects)), который при запуске все делает автоматически. Следующей важной задачей стало разбиение данных на тренировочную, валидационную и тестовую выборки, так как были фотографии, на которых могло содержаться несколько классов оборудования. В итоге был написан код в том же файле где и прошлый, который разделяет изображения по классам и для каждого класса случайным образом выбираются фотографии с аннотациями в указанном соотношении, а затем возможные пересечения из-за нескольких классов на фотографии удаляются. Так и получаются тренировочная и валидационная выборки. Конечно, дисбаланс плохо учитывается, но в этом нет ничего страшного. Тестовая выборка не создается, так как при обученнии модели в yml файле она просто не считывается. Оюучение было по батчам с 50 эпохами, где возникла еще одна проблема, которая заключалась в том, что при обучении модели по батчам, получалось, что в одном изображении 16 штук других, поэтому был написан код ([output](https://github.com/5Misha/Personal_projects)), который, используя обученную модель, делал детекцию по одной фотографии последовательно. 
Метрики подсчитывались автоматически самой моделью YOLO и получились такими:  
* mAP50 - 0.84
* mAP50-95 - 0.55


Описание прикрепленных файлов:  
* 